<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>99Play Secure Payment</title>

<style>

body{
font-family:Arial;
background:#020617;
color:white;
text-align:center;
padding:20px;
}

.container{
background:#0f172a;
padding:20px;
border-radius:12px;
max-width:400px;
margin:auto;
}

input,button{
width:100%;
padding:12px;
margin-top:10px;
border-radius:8px;
border:none;
font-size:16px;
}

button{
background:#22c55e;
color:white;
font-weight:bold;
}

.linkbox{
background:#020617;
padding:10px;
margin-top:10px;
word-break:break-all;
border-radius:8px;
}

.qr{
margin-top:15px;
}

.success{
color:#22c55e;
margin-top:10px;
}

</style>

</head>

<body>

<div class="container">

<h2>99Play Secure Payment</h2>

<input type="text" id="custname" placeholder="Customer Name">

<input type="number" id="amount" placeholder="Amount">

<button onclick="generateLink()">Generate Customer Link</button>

<div id="link" class="linkbox"></div>

<div id="qr" class="qr"></div>

<button onclick="pay()">Pay Now</button>

<input type="text" id="ref" placeholder="Enter UPI Reference Number">

<button onclick="verify()">Verify Payment</button>

<div id="status"></div>

</div>

<script>

const upi="sejal558211@okicici";
const merchant="99play";

const params=new URLSearchParams(window.location.search);

const lockedAmount=params.get("amount");
const lockedName=params.get("name");
const txn=params.get("txn");

if(lockedAmount){

document.getElementById("amount").value=lockedAmount;
document.getElementById("amount").readOnly=true;

}

if(lockedName){

document.getElementById("custname").value=lockedName;
document.getElementById("custname").readOnly=true;

}

function generateLink(){

let name=document.getElementById("custname").value;
let amount=document.getElementById("amount").value;

if(!name || !amount){

alert("Enter name and amount");
return;

}

let txnid="TXN"+Date.now();

let url=window.location.origin+window.location.pathname+
"?name="+encodeURIComponent(name)+
"&amount="+amount+
"&txn="+txnid;

document.getElementById("link").innerHTML=url;

generateQR(name,amount,txnid);

}

function generateQR(name,amount,txnid){

let upilink=`upi://pay?pa=${upi}&pn=${merchant}&am=${amount}&tn=${name}-${txnid}&cu=INR`;

let qr=`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(upilink)}`;

document.getElementById("qr").innerHTML=`<img src="${qr}">`;

}

function pay(){

let name=document.getElementById("custname").value;
let amount=document.getElementById("amount").value;
let txnid=txn || "TXN"+Date.now();

let upilink=`upi://pay?pa=${upi}&pn=${merchant}&am=${amount}&tn=${name}-${txnid}&cu=INR`;

window.location.href=upilink;

}

function verify(){

let ref=document.getElementById("ref").value;

if(!ref){

alert("Enter reference number");
return;

}

let used=localStorage.getItem(ref);

if(used){

document.getElementById("status").innerHTML=
"<div style='color:red'>Reference already used ❌</div>";

return;

}

localStorage.setItem(ref,"used");

document.getElementById("status").innerHTML=
"<div class='success'>Payment Verified Successfully ✅</div>";

}

if(lockedAmount && lockedName){

generateQR(lockedName,lockedAmount,txn);

}

</script>

</body>
</html>
